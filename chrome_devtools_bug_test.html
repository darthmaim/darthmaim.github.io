<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
<p>Rich offline experiences, periodic background syncs, push notifications&mdash;
    functionality that would normally require a native application&mdash;are coming to
    the web. Service workers provide the technical foundation that all these
    features will rely on.</p>

<h2 id="toc-what">What is a Service Worker?</h2>

<p>A service worker is a script that is run by your browser in the background,
    separate from a web page, opening the door to features which don't need a web
    page or user interaction. In the future this will include push messages,
    background sync, and geofencing, but the first feature it will launch with is
    the ability to intercept and handle network requests, including programmatically
    managing a cache of responses.</p>

<p>The reason this is such an exciting API is that it allows you to support offline
    experiences, giving developers complete control over what exactly that
    experience is.</p>

<p>Before service worker there was one other API that would give users an offline
    experience on the web called <a href="http://www.html5rocks.com/en/tutorials/appcache/beginner/">App
        Cache</a>. The major
    issue with App Cache is the <a href="http://alistapart.com/article/application-cache-is-a-douchebag">number
        of gotcha's that exist</a> as well
    as the design working particularly well for single page web apps, but not for
    multi-page sites. Service workers have been designed to avoid these common pain
    points.</p>

<p>Things to note about a service worker:</p>

<ul>
    <li>It's a <a href="http://www.html5rocks.com/en/tutorials/workers/basics/">JavaScript
        Worker</a>, so it can't
        access the DOM directly. Instead, a service worker can communicate with the
        pages it controls by responding to messages sent via the
        <a href="https://www.google.com/url?q=https%3A%2F%2Fhtml.spec.whatwg.org%2Fmultipage%2Fworkers.html%23dom-worker-postmessage&sa=D&sntz=1&usg=AFQjCNEhZhiJ-IbVSs5w1M3WanXGoKLjlQ">PostMessage</a>
        interface, and those pages can manipulate the DOM if needed.</li>
    <li>Service worker is a programmable network proxy, allowing you to control
        how network requests from your page are handled.</li>
    <li>It will be terminated when not in use, and restarted when it's next needed, so
        you cannot rely on global state within a service worker's `onfetch` and
        `onmessage` handlers. If there is information that you need to persist and
        reuse across restarts, service workers do have access to the
        <a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API">IndexedDB</a>
        API.</li>
    <li>Service workers make extensive use of promises, so if you're new to promises,
        then you should stop reading this and check out <a href="http://www.html5rocks.com/en/tutorials/es6/promises/">Jake Archibald's
            article</a>.</li>
</ul>

<h2 id="lifecycle">Service Worker Lifecycle</h2>

<p>A service worker has a lifecycle which is completely separate from your web
    page.</p>

<p>To install a service worker for your site, you need to <strong>register</strong> it, which
    you do in your page's JavaScript. Registering a service worker will cause the
    browser to start the service worker install step in the background.</p>

<p>Typically during the install step, you'll want to cache some static assets. If
    all the files are cached successfully, then the service worker becomes
    installed. If any of the files fail to download and cache, then the install step
    will fail and the service worker won't activate (i.e. won't be installed). If
    that happens, don't worry, it'll try again next time. But that means if it
    <em>does</em> install, you <strong>know</strong> you've got those static assets in the cache.</p>

<p>When we're installed, the activation step will follow and this is a great
    opportunity for handling any management of old caches, which we'll cover during
    the service worker update section.</p>

<p>After the activation step, the service worker will control all pages that fall
    under its scope, though the page that registered the service worker for the
    first time won't be controlled until it's loaded again. Once a service worker is
    in control, it will be in one of two states:  either the service worker will be
    terminated to save memory, or it will handle fetch and message events which
    occur when a network request or message is made from your page.</p>


</body>
</html>
